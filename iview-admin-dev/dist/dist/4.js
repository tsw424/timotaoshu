webpackJsonp([4],{244:function(t,e,o){"use strict";function i(t){u||o(466)}Object.defineProperty(e,"__esModule",{value:!0});var a=o(423),n=o.n(a);for(var s in a)"default"!==s&&function(t){o.d(e,t,function(){return a[t]})}(s);var r=o(480),l=o.n(r),u=!1,c=o(4),p=i,d=c(n.a,l.a,!1,p,null,null);d.options.__file="src\\views\\home\\home.vue",e.default=d.exports},278:function(t,e,o){t.exports={default:o(279),__esModule:!0}},279:function(t,e,o){o(280),t.exports=o(0).Object.assign},280:function(t,e,o){var i=o(8);i(i.S+i.F,"Object",{assign:o(281)})},281:function(t,e,o){"use strict";var i=o(26),a=o(54),n=o(34),s=o(33),r=o(94),l=Object.assign;t.exports=!l||o(20)(function(){var t={},e={},o=Symbol(),i="abcdefghijklmnopqrst";return t[o]=7,i.split("").forEach(function(t){e[t]=t}),7!=l({},t)[o]||Object.keys(l({},e)).join("")!=i})?function(t,e){for(var o=s(t),l=arguments.length,u=1,c=a.f,p=n.f;l>u;)for(var d,f=r(arguments[u++]),h=c?i(f).concat(c(f)):i(f),k=h.length,v=0;k>v;)p.call(f,d=h[v++])&&(o[d]=f[d]);return o}:l},423:function(t,e,o){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=o(278),n=i(a),s=o(16),r=i(s),l=o(96),u=i(l),c=o(468),p=i(c),d=o(472),f=i(d),h=o(476),k=i(h);e.default={name:"home",components:{description:p.default,wbImg:f.default,editBook:k.default},data:function(){var t=this;return{columns:[{type:"selection",key:"selection",width:60,align:"center"},{title:"id",key:"id",render:function(e,o){return e("div",[e("a",{attrs:{href:"javascript:void(0);"},on:{click:function(e){t.$router.push("/catalog?bookId="+o.row.id),e.stopPropagation(),e.preventDefault()}}},o.row.id),e("a",{attrs:{href:"javascript:void(0);",style:"margin-left:5px;color:"+(2==o.row.isJin&&"red;")},on:{click:function(e){t.onClickUpdateBookisJin(o.row.id,"2"==o.row.isJin?"1":"2",o.row.name)}}},1==o.row.isJin?"(禁用)":"(启用)")])}},{title:"书名",key:"name"},{title:"小说类型",key:"bookType"},{title:"作者",key:"author"},{title:"来源名称",key:"reptileType",render:function(e,o){return e("a",{attrs:{href:"javascript:void(0);",target:"_blank"},on:{click:function(e){t.$router.push("/reptile-tool/channel")}}},t.reptileList[o.row.reptileType].name)}},{title:"来源地址",key:"OriginUrl",render:function(t,e){return t("a",{attrs:{href:e.row.OriginUrl,target:"_blank"}},e.row.OriginUrl)}},{title:"图片地址",key:"imgUrl",render:function(e,o){return e("img",{attrs:{src:u.default.apiUrl+"/images/"+o.row.id,style:"max-width:50px; max-height:50px;display:block;margin:2px;"},on:{mouseenter:function(e){e.stopPropagation(),e.preventDefault(),t.bigImg.url=e.target.src},mousemove:function(e){e.stopPropagation(),e.preventDefault(),t.bigImg.right=document.activeElement.clientWidth-e.clientX,t.bigImg.top=e.clientY},mouseleave:function(e){e.stopPropagation(),e.preventDefault(),t.bigImg.url="",t.bigImg.right=0,t.bigImg.top=0}}})}},{title:"爬取状态",key:"type",render:function(t,e){return t("span",{attrs:{style:"color:"+(3!=e.row.type&&"red;")}},"3"==e.row.type?"已爬取":"未爬取")}},{title:"小说状态",key:"bookStatus",render:function(e,o){return e("div",[e("span",{attrs:{style:"color:"+(1!=o.row.bookStatus&&"red;")}},"1"==o.row.bookStatus?"连载":"完本"),e("a",{attrs:{href:"javascript:void(0);",style:"color:"+(1==o.row.bookStatus&&"red;")},on:{click:function(){t.onClickUpdateBookStatus(o.row.id,"1"==o.row.bookStatus?2:1,o)}}},"1"==o.row.bookStatus?"(转完本)":"(转连载)")])}},{title:"更新时间",key:"updateTime",render:function(t,e){return t("span",{},r.default.timeChange(e.row.updateTime))}},{title:"操作",key:"updateTime",render:function(e,o){return e("div",[e("a",{attrs:{href:"javascript:void(0);"},on:{click:function(){t.onClickUpdateBookInfo(o.row.id)}}},"更新小说基本信息"),e("a",{attrs:{href:"javascript:void(0);",style:"margin-left:10px;"},on:{click:function(){if("1"!=o.row.bookStatus)return void t.$Message.info("已经是最新章节");t.onClickUpdateNewCatalog(o.row.id,o.row.name)}}},"1"==o.row.bookStatus?"更新到最新章节":"已经是最新章节"),e("a",{attrs:{href:"javascript:void(0);",style:"margin-left:10px;"},on:{click:function(e){t.showEdit(o.row)}}},"编辑"),e("a",{attrs:{href:"javascript:void(0);",style:"margin-left:10px;"},on:{click:function(){t.onClickDelBook(o.row.id,o.row.name)}}},"删除")])}},{title:"描述",type:"expand",width:70,render:function(t,e){return t(p.default,{props:{row:e.row}})}}],books:[],params:{page:null,limit:null},total:1,loading:!1,selectList:[{value:"",label:"全部"},{value:"bookId",label:"bookId"},{value:"bookName",label:"书名"},{value:"author",label:"作者名"},{value:"description",label:"描述"}],bookStatusList:[{value:"",label:"全部"},{value:"1",label:"连载"},{value:"2",label:"完本"}],bookStatus:"",selectName:"",inputValue:"",inputPlaceholder:"",reptileStatusList:[{value:"",label:"全部"},{value:3,label:"已爬"},{value:2,label:"未爬"}],isJinList:[{value:"",label:"全部"},{value:"1",label:"启用"},{value:"2",label:"禁用"}],isJin:"",type:"",isme:!1,bigImg:{url:"",right:0,top:0},bookTypeList:[],bookType:"",reptileList:{length:0},editStatus:{status:!1},selection:[]}},computed:{},methods:{getBooks:function(t){var e=this;if(!this.loading){t>0&&(this.params.page=t);var o={params:{page:this.params.page,limit:this.params.limit}};this.selectName&&this.inputValue&&(o.params[this.selectName]=this.inputValue),this.type&&(o.params.type=this.type),this.bookType&&"全部"!=this.bookType&&(o.params.bookType=this.bookType),this.bookStatus&&(o.params.bookStatus=this.bookStatus),this.isJin&&(o.params.isJin=this.isJin),this.loading=!0,this.$router.replace({path:"/home",query:(0,n.default)({},o.params)}),r.default.post.books.book(o).then(function(t){e.books=t.book,e.total=t.count,e.loading=!1,e.$nextTick(function(){e.$refs.table.selectAll(!0)})}).catch(function(t){e.loading=!1})}},expandToggle:function(t,e){this.$refs.table.$el.getElementsByClassName("ivu-table-cell-expand")[e].click()},selectChange:function(t){this.isme&&(this.inputValue="",t.value?this.inputPlaceholder="请输入"+t.label:(this.inputPlaceholder="",this.getBooks(1)))},onClickSearch:function(){this.isme&&this.getBooks(1)},onClickUpdateBookInfo:function(t){var e=this;if(!this.loading){var o={params:{bookId:t}};this.loading=!0,r.default.post.books.updateBookInfo(o).then(function(t){e.loading=!1,t.book[0].isHandle?(e.$Message.success("已更新"),e.getBooks()):e.$Message.success("已是最新状态")}).catch(function(t){console.log(t),e.loading=!1})}},onClickUpdateNewCatalog:function(t,e){var o=this;if(!this.loading){this.loading=!0;var i={params:{bookId:t,bookName:e}};r.default.post.books.updateNewCatalog(i).then(function(t){o.loading=!1,o.getBooks()}).catch(function(t){o.getBooks(),o.loading=!1})}},onClickOneKeyUpdateNewCatalog:function(){var t=this;if(!this.loading){this.loading=!0;var e={params:{}};r.default.post.books.oneKeyUpdateNewCatalog(e).then(function(e){t.loading=!1,t.getBooks()}).catch(function(e){t.getBooks(),t.loading=!1})}},onclickOneKeyGetAllBookImg:function(){var t=this;if(!this.loading){this.loading=!0;var e={params:{}};r.default.post.common.oneKeyGetAllBookImg(e).then(function(){t.loading=!1}).catch(function(e){t.loading=!1})}},onClickDelBook:function(t,e){var o=this;this.$Modal.confirm({closable:!0,title:"温馨提示",content:"<p>你确定要删除《"+e+"》吗？</p>",onOk:function(){if(!o.loading){o.loading=!0;var i={params:{bookId:t,bookName:e}};r.default.post.books.delBook(i).then(function(t){o.$Message.success(t),o.loading=!1,o.getBooks()}).catch(function(t){o.loading=!1})}},onCancel:function(){o.$Message.info("你取消了删除")}})},onClickUpdateBookStatus:function(t,e,o){var i=this,a=1==e?"连载":"完本";this.$Modal.confirm({closable:!0,title:o.row.name+"_"+o.row.author,content:"<p>你确定要转成"+a+"状态?</p>",onOk:function(){if(!i.loading){var o={params:{bookId:t,bookStatus:e}};i.loading=!0,r.default.post.books.updateBookStatus(o).then(function(t){i.$Message.success("已转为"+(1==e?"连载":"完本")),i.loading=!1,i.getBooks()}).catch(function(t){i.loading=!1})}},onCancel:function(){i.$Message.info("你取消了转换")}})},getBookTypeList:function(t){var e=this,o={params:{}};r.default.post.type.bookTypeList(o).then(function(t){t.bookTypeList.unshift({bookType:"NULL"}),t.bookTypeList.unshift({bookType:"全部"}),e.bookTypeList=t.bookTypeList}).catch(function(t){console.error("err")})},onClickSelect:function(t){this.selection=t},onClickUpdateBookisJin:function(t,e,o){var i=this,a={};if(e)a={params:{bookId:t,isJin:e}};else{var n=[];this.selection.forEach(function(t,e){n.push(t.id)}),a={params:{bookIds:n.join(","),isJin:1}}}this.loading=!0,r.default.post.books.updateBookIsJin(a).then(function(t){i.$Message.success(t),i.loading=!1,i.getBooks()}).catch(function(t){i.loading=!1,1==e&&i.$router.push("/reptile-tool/progress-error?bookName="+o)})},getReptileList:function(){var t=this,e={params:{}};r.default.post.reptile.list(e).then(function(e){t.reptileList={},e.reptileList.forEach(function(e,o){t.reptileList[e.reptileTypeId]=e}),t.reptileList.length=e.reptileList.length}).catch(function(t){})},activatedStart:function(){var t=this,e=parseInt(this.$route.query.page)||1,o=parseInt(this.$route.query.limit)||10,i=parseInt(this.$route.query.type)||"",a=this.$route.query.bookType||"",n=this.$route.query.bookStatus||"",s=this.$route.query.isJin||"",r="",l="";this.bookTypeList.length<=0&&this.getBookTypeList(),this.selectList.forEach(function(e,o){t.$route.query[e.value]&&(r=e.value,l=t.$route.query[e.value])}),e===this.params.page&&o===this.params.limit&&i===this.type&&r===this.selectName&&l===this.inputValue&&a===this.bookType&&this.bookStatus===n&&this.isJin===s||(this.type!==i&&(this.type=i),this.selectName!==r&&(this.selectName=r),this.inputValue!==l&&(this.inputValue=l),this.bookStatus!==n&&(this.bookStatus=n),this.isJin!==s&&(this.isJin=s),this.bookType!==a&&(this.bookTypeList.length<=0&&(this.bookTypeList=[{bookType:"全部"},{bookType:a}]),this.bookType=a),e!==this.params.page&&(this.params.page=e),o!==this.params.limit&&(this.params.limit=o),this.getBooks()),this.$nextTick(function(){t.isme=!0})},start:function(){var t=this;if(this.reptileList.length>0)this.activatedStart();else var e=setTimeout(function(){t.start(),clearTimeout(e),e=null},300)},showEdit:function(t){this.$refs.edit.$emit("editBook",t)}},created:function(){this.getReptileList()},mounted:function(){},activated:function(){this.start()},deactivated:function(){this.isme=!1}}},424:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{row:Object}}},425:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["img","right","top"],name:"wb-img",data:function(){return{}},computed:{},methods:{},components:{},created:function(){},mounted:function(){},beforeDestroy:function(){},destroyed:function(){}}},426:function(t,e,o){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=o(278),n=i(a),s=o(96),r=(i(s),o(16)),l=i(r);e.default={name:"edit-book",props:{edit:{type:Object,default:{status:!1}},bookTypeList:{type:Array,default:[]}},data:function(){return{loading:!1,eidtError:"",editBook:{},validate:{bookType:[{required:!0,message:"请选择类型",trigger:"blur"}],author:[{required:!0,message:"请输入小说作者",trigger:"blur"}]}}},computed:{},methods:{cancel:function(){this.edit.status=!1},save:function(){var t=this;if(!this.loading){var e={params:{id:this.editBook.id,bookType:this.editBook.bookType}};this.loading=!0,l.default.post.books.editBookInfo(e).then(function(e){t.loading=!1,t.cancel(),console.log(t.$parent),t.$emit("search"),console.log(e)}).catch(function(e){t.loading=!1})}}},components:{},created:function(){},mounted:function(){var t=this;this.$on("editBook",function(e){t.edit.status=!0,t.editBook=(0,n.default)({},e)})},beforeDestroy:function(){},destroyed:function(){},activated:function(){},deactivated:function(){}}},466:function(t,e,o){var i=o(467);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);o(19)("55175e39",i,!1,{})},467:function(t,e,o){e=t.exports=o(18)(!1),e.push([t.i,"",""])},468:function(t,e,o){"use strict";function i(t){u||o(469)}Object.defineProperty(e,"__esModule",{value:!0});var a=o(424),n=o.n(a);for(var s in a)"default"!==s&&function(t){o.d(e,t,function(){return a[t]})}(s);var r=o(471),l=o.n(r),u=!1,c=o(4),p=i,d=c(n.a,l.a,!1,p,"data-v-33df4762",null);d.options.__file="src\\views\\home\\components\\description.vue",e.default=d.exports},469:function(t,e,o){var i=o(470);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);o(19)("5dc53c68",i,!1,{})},470:function(t,e,o){e=t.exports=o(18)(!1),e.push([t.i,"\n.expand-row[data-v-33df4762]{\n    margin-bottom: 16px;\n}\n",""])},471:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("Row",{staticClass:"expand-row"},[o("Col",{attrs:{span:"24"}},[o("span",{staticClass:"expand-key"},[t._v("描述: ")]),t._v(" "),o("span",{staticClass:"expand-value"},[t._v(t._s(t.row.description))])])],1)],1)},a=[];i._withStripped=!0;var n={render:i,staticRenderFns:a};e.default=n},472:function(t,e,o){"use strict";function i(t){u||o(473)}Object.defineProperty(e,"__esModule",{value:!0});var a=o(425),n=o.n(a);for(var s in a)"default"!==s&&function(t){o.d(e,t,function(){return a[t]})}(s);var r=o(475),l=o.n(r),u=!1,c=o(4),p=i,d=c(n.a,l.a,!1,p,null,null);d.options.__file="src\\views\\home\\components\\wb-img.vue",e.default=d.exports},473:function(t,e,o){var i=o(474);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);o(19)("006909cc",i,!1,{})},474:function(t,e,o){e=t.exports=o(18)(!1),e.push([t.i,"\n.wb-img{\n    position: fixed;\n    max-width: 60%;\n    max-height: 80%;\n    z-index: 1000;\n    top:100px;\n}\n",""])},475:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("img",{staticClass:"wb-img",style:{right:t.right?t.right+100+"px":"auto",top:t.top?t.top-100+"px":"100px"},attrs:{src:t.img}})])},a=[];i._withStripped=!0;var n={render:i,staticRenderFns:a};e.default=n},476:function(t,e,o){"use strict";function i(t){u||o(477)}Object.defineProperty(e,"__esModule",{value:!0});var a=o(426),n=o.n(a);for(var s in a)"default"!==s&&function(t){o.d(e,t,function(){return a[t]})}(s);var r=o(479),l=o.n(r),u=!1,c=o(4),p=i,d=c(n.a,l.a,!1,p,"data-v-11791deb",null);d.options.__file="src\\modal\\home\\editBook.vue",e.default=d.exports},477:function(t,e,o){var i=o(478);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);o(19)("56db730c",i,!1,{})},478:function(t,e,o){e=t.exports=o(18)(!1),e.push([t.i,"",""])},479:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("Modal",{attrs:{closable:!1,"mask-closable":!1,width:500},model:{value:t.edit.status,callback:function(e){t.$set(t.edit,"status",e)},expression:"edit.status"}},[o("h3",{staticClass:"modal-header-color",attrs:{slot:"header"},slot:"header"},[t._v("编辑 "+t._s(t.editBook.name))]),t._v(" "),o("Form",{ref:"editBook",attrs:{model:t.editBook,"label-width":100,"label-position":"right",rules:t.validate}},[o("FormItem",{attrs:{label:"小说编号：",prop:"id",error:t.eidtError}},[o("label",[t._v(t._s(t.editBook.id))])]),t._v(" "),o("FormItem",{attrs:{label:"小说类型：",prop:"bookType",error:t.eidtError}},[o("Select",{staticClass:"w100",attrs:{placeholder:"全部","label-in-value":""},model:{value:t.editBook.bookType,callback:function(e){t.$set(t.editBook,"bookType",e)},expression:"editBook.bookType"}},t._l(t.bookTypeList,function(e){return o("Option",{directives:[{name:"show",rawName:"v-show",value:"全部"!=e.bookType,expression:"item.bookType!='全部'"}],key:e.bookType,attrs:{value:e.bookType}},[t._v(t._s(e.bookType))])}))],1),t._v(" "),o("FormItem",{attrs:{label:"小说作者：",prop:"author",error:t.eidtError}},[o("Input",{attrs:{placeholder:"请输入小说作者",type:"text",disabled:""},nativeOn:{keyup:function(e){return"button"in e||13===e.keyCode?t.save(e):null}},model:{value:t.editBook.author,callback:function(e){t.$set(t.editBook,"author",e)},expression:"editBook.author"}})],1)],1),t._v(" "),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{attrs:{type:"text",loading:t.loading},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),o("Button",{attrs:{type:"primary",loading:t.loading},on:{click:t.save}},[t._v("保存")])],1)],1)},a=[];i._withStripped=!0;var n={render:i,staticRenderFns:a};e.default=n},480:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("Layout",[o("Card",[o("Row",[o("Col",{attrs:{span:"12"}},[o("Select",{staticClass:"w100",attrs:{placeholder:"全部","label-in-value":""},on:{"on-change":t.selectChange},model:{value:t.selectName,callback:function(e){t.selectName=e},expression:"selectName"}},t._l(t.selectList,function(e){return o("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),t._v(" "),o("Input",{directives:[{name:"show",rawName:"v-show",value:t.selectName,expression:"selectName"}],staticClass:"w200",attrs:{placeholder:t.inputPlaceholder,clearable:""},nativeOn:{keyup:function(e){return"button"in e||13===e.keyCode?t.onClickSearch(e):null}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}),t._v(" "),o("Select",{staticClass:"w100",attrs:{placeholder:"全部","label-in-value":""},on:{"on-change":t.onClickSearch},model:{value:t.isJin,callback:function(e){t.isJin=e},expression:"isJin"}},t._l(t.isJinList,function(e){return o("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),t._v(" "),o("Select",{staticClass:"w100",attrs:{placeholder:"全部","label-in-value":""},on:{"on-change":t.onClickSearch},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.reptileStatusList,function(e){return o("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),t._v(" "),o("Select",{staticClass:"w100",attrs:{placeholder:"全部","label-in-value":""},on:{"on-change":t.onClickSearch},model:{value:t.bookType,callback:function(e){t.bookType=e},expression:"bookType"}},t._l(t.bookTypeList,function(e){return o("Option",{key:e.bookType,attrs:{value:e.bookType}},[t._v(t._s(e.bookType))])})),t._v(" "),o("Select",{staticClass:"w100",attrs:{placeholder:"全部","label-in-value":""},on:{"on-change":t.onClickSearch},model:{value:t.bookStatus,callback:function(e){t.bookStatus=e},expression:"bookStatus"}},t._l(t.bookStatusList,function(e){return o("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1),t._v(" "),o("Col",{staticClass:"tr",attrs:{span:"12"}},[o("Button",{attrs:{type:"primary",disabled:t.loading},on:{click:t.onClickSearch}},[t._v("搜索")]),t._v(" "),o("Button",{attrs:{type:"primary",disabled:t.loading},on:{click:t.onClickUpdateBookisJin}},[t._v("批量启用")]),t._v(" "),o("Button",{attrs:{type:"primary",disabled:t.loading},on:{click:t.onClickOneKeyUpdateNewCatalog}},[t._v("一键全部更新至最新章节")]),t._v(" "),o("Button",{attrs:{type:"primary",disabled:t.loading},on:{click:t.onclickOneKeyGetAllBookImg}},[t._v("一键更新全部图片")])],1)],1)],1),t._v(" "),o("Card",{attrs:{shadow:""}},[o("Table",{ref:"table",attrs:{border:"","highlight-row":"",loading:t.loading,columns:t.columns,data:t.books},on:{"on-row-dblclick":t.expandToggle,"on-selection-change":t.onClickSelect}})],1),t._v(" "),o("Card",{attrs:{shadow:""}},[o("Page",{attrs:{current:t.params.page,"page-size":t.params.limit,total:t.total,"show-total":"","show-elevator":""},on:{"on-change":t.getBooks}})],1),t._v(" "),o("wb-img",{attrs:{img:t.bigImg.url,right:t.bigImg.right,top:t.bigImg.top}}),t._v(" "),o("edit-book",{ref:"edit",attrs:{edit:t.editStatus,"book-type-list":t.bookTypeList},on:{search:t.onClickSearch}})],1)},a=[];i._withStripped=!0;var n={render:i,staticRenderFns:a};e.default=n}});