webpackJsonp([8],{256:function(e,t,o){"use strict";function i(e){d||o(515)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(441),n=o.n(a);for(var l in a)"default"!==l&&function(e){o.d(t,e,function(){return a[e]})}(l);var s=o(521),r=o.n(s),d=!1,c=o(4),u=i,f=c(n.a,r.a,!1,u,"data-v-c7359e82",null);f.options.__file="src\\views\\Permission\\role.vue",t.default=f.exports},441:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=o(517),n=i(a),l=o(16),s=i(l);t.default={name:"role",data:function(){var e=this;return{columns:[{type:"selection",width:60,align:"center"},{title:"id",key:"id"},{title:"角色",key:"roleName"},{title:"操作",key:"handle",render:function(t,o){return t("div",[t("a",{attrs:{href:"javascript:void(0);"},on:{click:function(){e.$refs.editRole.$emit("reset",o.row),e.modal.showModal=!0}}},"编辑"),t("a",{attrs:{href:"javascript:void(0);",style:"margin-left:10px;"},on:{click:function(){e.onClickDel(o.row.id)}}},"删除")])}}],loading:!1,roleList:[],params:{page:1,limit:20},total:30,selection:[],modal:{showModal:!1}}},computed:{},methods:{getRoleList:function(e){var t=this;if(!this.loading){e||(e=1);var o={params:{page:this.params.page,limit:this.params.limit}};this.loading=!0,s.default.post.permission.roleList(o).then(function(e){t.loading=!1,t.total=e.count,t.roleList=e.roleList}).catch(function(e){t.loading=!1})}},onClickAddRole:function(){this.$refs.editRole.$emit("reset",null),this.modal.showModal=!0},onClickDel:function(e){var t=this;if(!this.loading){if(!e){var o=[];this.selection.forEach(function(e,t){o.push(e.id)}),e=o.join(",")}var i={params:{ids:e}};this.loading=!0,s.default.post.permission.delRole(i).then(function(e){t.loading=!1,t.getRoleList()}).catch(function(e){t.loading=!1})}},onClickSelect:function(e){this.selection=e}},components:{editRole:n.default},created:function(){},mounted:function(){this.getRoleList()},beforeDestroy:function(){},destroyed:function(){},activated:function(){},deactivated:function(){}}},442:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=o(35),n=i(a),l=o(16),s=i(l);t.default={name:"edit-role",props:{modal:{type:Object,default:{showModal:!0}}},data:function(){return{loading:!1,oldPassError:"",rules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},role:{roleName:"",permission:[],id:null},baseData:[],selection:[],isAdd:!0}},computed:{},methods:{onClickCancel:function(){this.modal.showModal=!1},onClickSave:function(){var e=this;this.$refs.roleForm.validate(function(t){if(t){if(e.loading)return;var o=[],i=[];if(e.selection.forEach(function(e,t){if(e.id){var a=e.id+"",n=a.substr(0,a.length-3);-1==o.indexOf(n+"000")&&o.push(n+"000"),i.push(a)}}),e.isAdd){var a={params:{roleName:e.role.roleName,permission:o.concat(i).join(",")}};e.loading=!0,s.default.post.permission.addRole(a).then(function(t){e.loading=!1,e.modal.showModal=!1,e.$emit("getRoleList")}).catch(function(t){e.loading=!1})}else{var n={params:{roleName:e.role.roleName,permission:o.concat(i).join(","),id:e.role.id}};e.loading=!0,s.default.post.permission.editRole(n).then(function(t){e.loading=!1,e.modal.showModal=!1,e.$emit("getRoleList")}).catch(function(t){e.loading=!1})}}})},onCheckChange:function(e){this.selection=e},getList:function(){var e=this,t={params:{}};s.default.post.permission.list(t).then(function(t){e.baseData=t,e.role.permission=JSON.parse((0,n.default)(e.baseData))}).catch(function(e){})},editInitPermission:function(e,t){var o=this;e.forEach(function(e,i){e.children?o.editInitPermission(e.children,t):-1==t.indexOf("all")&&-1==t.indexOf(e.id+"")||(e.checked=!0)})}},components:{},created:function(){this.getList()},mounted:function(){var e=this;this.$on("reset",function(t){if(t){e.role.roleName=t.roleName,e.role.id=t.id;var o=JSON.parse((0,n.default)(e.baseData)),i=t.permission.split(",");e.editInitPermission(o,i),e.role.permission=o,e.isAdd=!1}else e.role.permission=JSON.parse((0,n.default)(e.baseData)),e.role.roleName="",e.role.id=null,e.isAdd=!0})},beforeDestroy:function(){},destroyed:function(){},activated:function(){},deactivated:function(){}}},515:function(e,t,o){var i=o(516);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);o(19)("22a9fb19",i,!1,{})},516:function(e,t,o){t=e.exports=o(18)(!1),t.push([e.i,"",""])},517:function(e,t,o){"use strict";function i(e){d||o(518)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(442),n=o.n(a);for(var l in a)"default"!==l&&function(e){o.d(t,e,function(){return a[e]})}(l);var s=o(520),r=o.n(s),d=!1,c=o(4),u=i,f=c(n.a,r.a,!1,u,"data-v-2c3193c8",null);f.options.__file="src\\modal\\permission\\editRole.vue",t.default=f.exports},518:function(e,t,o){var i=o(519);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);o(19)("5812e50a",i,!1,{})},519:function(e,t,o){t=e.exports=o(18)(!1),t.push([e.i,"",""])},520:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("Modal",{attrs:{closable:!1,"mask-closable":!0,width:500},on:{"on-cancel":e.onClickCancel},model:{value:e.modal.showModal,callback:function(t){e.$set(e.modal,"showModal",t)},expression:"modal.showModal"}},[o("h3",{staticClass:"modal-header-color",attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.isAdd?"新增角色":"编辑角色"))]),e._v(" "),o("Form",{ref:"roleForm",attrs:{model:e.role,"label-width":100,"label-position":"right",rules:e.rules}},[o("Form-item",{attrs:{label:"角色名称",prop:"roleName"}},[o("Input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.role.roleName,callback:function(t){e.$set(e.role,"roleName",t)},expression:"role.roleName"}})],1),e._v(" "),o("Form-item",{attrs:{label:"选择菜单"}},[o("Tree",{attrs:{data:e.role.permission,"show-checkbox":""},on:{"on-check-change":e.onCheckChange}})],1)],1),e._v(" "),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{attrs:{type:"text"},on:{click:e.onClickCancel}},[e._v("取消")]),e._v(" "),o("Button",{attrs:{type:"primary",loading:e.loading},on:{click:e.onClickSave}},[e._v(e._s(e.isAdd?"新增":"保存"))])],1)],1)},a=[];i._withStripped=!0;var n={render:i,staticRenderFns:a};t.default=n},521:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("layout",[o("edit-role",{ref:"editRole",attrs:{modal:e.modal},on:{getRoleList:e.getRoleList}}),e._v(" "),o("Card",[o("Row",[o("Col",{staticClass:"tl",attrs:{span:"12"}},[o("Button",{attrs:{type:"primary",disabled:e.loading},on:{click:e.onClickAddRole}},[e._v("新增角色")])],1),e._v(" "),o("Col",{staticClass:"tr",attrs:{span:"12"}},[o("span",[e._v("批量操作：")]),e._v(" "),o("Button",{attrs:{type:"primary",disabled:e.loading},on:{click:function(t){e.onClickDel()}}},[e._v("删除角色")])],1)],1)],1),e._v(" "),o("Card",{attrs:{shadow:""}},[o("Table",{ref:"table",attrs:{border:"","highlight-row":"",loading:e.loading,columns:e.columns,data:e.roleList},on:{"on-selection-change":e.onClickSelect}})],1),e._v(" "),o("Card",{attrs:{shadow:""}},[o("Page",{attrs:{current:e.params.page,"page-size":e.params.limit,total:e.total,"show-total":"","show-elevator":""},on:{"on-change":e.getRoleList}})],1)],1)},a=[];i._withStripped=!0;var n={render:i,staticRenderFns:a};t.default=n}});