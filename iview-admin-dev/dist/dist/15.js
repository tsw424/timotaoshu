webpackJsonp([15],{250:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i(434),a=i.n(o);for(var n in o)"default"!==n&&function(t){i.d(e,t,function(){return o[t]})}(n);var r=i(503),l=i.n(r),s=i(4),c=s(a.a,l.a,!1,null,null,null);c.options.__file="src\\views\\reptile-tool\\progress-error.vue",e.default=c.exports},278:function(t,e,i){t.exports={default:i(279),__esModule:!0}},279:function(t,e,i){i(280),t.exports=i(0).Object.assign},280:function(t,e,i){var o=i(8);o(o.S+o.F,"Object",{assign:i(281)})},281:function(t,e,i){"use strict";var o=i(26),a=i(54),n=i(34),r=i(33),l=i(94),s=Object.assign;t.exports=!s||i(20)(function(){var t={},e={},i=Symbol(),o="abcdefghijklmnopqrst";return t[i]=7,o.split("").forEach(function(t){e[t]=t}),7!=s({},t)[i]||Object.keys(s({},e)).join("")!=o})?function(t,e){for(var i=r(t),s=arguments.length,c=1,u=a.f,p=n.f;s>c;)for(var d,f=l(arguments[c++]),h=u?o(f).concat(u(f)):o(f),m=h.length,g=0;m>g;)p.call(f,d=h[g++])&&(i[d]=f[d]);return i}:s},434:function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=i(278),n=o(a),r=i(16),l=o(r);e.default={name:"progress-error",data:function(){var t=this;return{loading:!1,reptileList:{length:0},columns:[{title:"id",key:"id"},{title:"备注",key:"reptileType",render:function(e,i){return e("span",{},""+t.reptileList[i.row.reptileType].name)}},{title:"书名",key:"bookName"},{title:"章节名",key:"catalogName",render:function(e,i){return e("a",{attrs:{href:"javascript:void(0)",target:"_blank"},on:{click:function(){t.onJumpToCatalogInfo(i.row.bookName,i.row.catalogName)}}},i.row.catalogName)}},{title:"来源地址",key:"originUrl",render:function(t,e){var i="";return i=0===e.row.reptileAddress.indexOf("http")?e.row.reptileAddress:e.row.originUrl+e.row.reptileAddress,t("a",{attrs:{href:i,target:"_blank"}},i)}},{title:"操作",key:"handle",render:function(e,i){return e("div",[e("a",{attrs:{href:"javascript:void(0);",style:"margin-left:10px;"},on:{click:function(){t.onClickDel(i.row.id)}}},"删除"),e("a",{attrs:{href:"javascript:void(0);",style:"margin-left:10px;",id:i.row.title+"_"+i.row.id},on:{click:function(){t.onClickUpdate(i)}}},"爬取"),e("a",{attrs:{href:"javascript:void(0);",style:"margin-left:10px;",id:i.row.title+"_ti"+i.row.id},on:{click:function(){t.onClickUpdate(i,1)}}},"替代式爬取"),e("a",{attrs:{href:"https://www.baidu.com/s?wd="+i.row.bookName,style:"margin-left:10px;",target:"_blank"}},"其他来源")])}}],list:[],params:{page:1,limit:10},total:0,bookName:"",showSimpleReptile:"",first:!0}},computed:{},methods:{onClickSearch:function(t){var e=this;if(!this.loading){t&&(this.params.page=t),this.bookName?this.showSimpleReptile=this.bookName:this.showSimpleReptile="";var i={params:{page:this.params.page,limit:this.params.limit}};this.bookName&&(i.params.bookName=this.bookName),this.$router.replace({path:"/reptile-tool/progress-error",query:(0,n.default)({},i.params)}),this.loading=!0,l.default.post.reptile.getProgressList(i).then(function(t){e.list=t.data,e.total=t.count,e.loading=!1}).catch(function(t){e.loading=!1})}},onClickDel:function(t){var e=this,i={params:{errorId:t}};this.loading=!0,l.default.post.reptile.deleteError(i).then(function(t){e.$Message.success(t),e.loading=!1,e.onClickSearch()}).catch(function(t){e.loading=!1})},onClickUpdate:function(t,e){var i=this,o=document.getElementById(t.row.title+"_"+(1==e?"ti":"")+t.row.id).innerHTML;if("已获取"!=o&&"正在获取中"!=o){document.getElementById(t.row.title+"_"+(1==e?"ti":"")+t.row.id).innerHTML="正在获取中";var a={params:{errorId:t.row.id,tiType:e}};l.default.post.reptile.restartCatalog(a).then(function(t){i.$Message.success(t),i.onClickSearch()}).catch(function(i){document.getElementById(t.row.title+"_"+(1==e?"ti":"")+t.row.id).innerHTML="获取失败"})}},onClickOneKey:function(t,e){var i=this,o={params:{}};"all"==t||(o.params.bookName=this.showSimpleReptile),e&&(o.params.tiType=1),this.loading=!0,l.default.post.reptile.oneKeyRestartCatalog(o).then(function(t){i.$Message.success(t),i.onClickSearch(),i.loading=!1}).catch(function(t){i.loading=!1})},onJumpToCatalogInfo:function(t,e){var i=this,o={params:{bookName:t,catalogName:e}};this.loading=!0,l.default.post.common.getCatalogFromInfo(o).then(function(t){if(i.loading=!1,t.count>0){var e=t.data[0],o=document.createElement("a");return o.href="/#/bookContainer?bookId="+e.bookId+"&catalogId="+e.id+"&num="+e.num,o.style.display="none",o.setAttribute("target","_blank"),o.click(),void o.remove()}i.$message.error("未知错误")}).catch(function(t){console.error(t),i.loading=!1})},getReptileList:function(){var t=this,e={params:{}};l.default.post.reptile.list(e).then(function(e){t.reptileList={},e.reptileList.forEach(function(e,i){t.reptileList[e.reptileTypeId]=e}),t.reptileList.length=e.reptileList.length}).catch(function(t){})},activatedStart:function(){var t=this.$route.query.bookName||"";(t!=this.bookName||this.first)&&(this.bookName=t,this.onClickSearch(),this.first=!1)},start:function(){var t=this;if(this.reptileList.length>0)this.activatedStart();else var e=setTimeout(function(){t.start(),clearTimeout(e),e=null},300)}},components:{},created:function(){this.getReptileList()},mounted:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){this.start()},deactivated:function(){}}},503:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Layout",[i("Card",[i("Row",[i("Col",{attrs:{span:"24"}},[i("Input",{staticClass:"w200",attrs:{placeholder:"输入书名",clearable:""},nativeOn:{keyup:function(e){if(!("button"in e)&&13!==e.keyCode)return null;t.onClickSearch(1)}},model:{value:t.bookName,callback:function(e){t.bookName=e},expression:"bookName"}}),t._v(" "),i("Button",{attrs:{type:"primary"},on:{click:function(e){t.onClickSearch(1)}}},[t._v("搜索")]),t._v(" "),t.showSimpleReptile?i("Button",{attrs:{type:"primary"},on:{click:function(e){t.onClickOneKey()}}},[t._v(t._s(t.showSimpleReptile)+"一键爬取")]):t._e(),t._v(" "),t.showSimpleReptile?i("Button",{attrs:{type:"primary"},on:{click:function(e){t.onClickOneKey("",!0)}}},[t._v(t._s(t.showSimpleReptile)+"替代式一键爬取")]):t._e(),t._v(" "),i("Button",{staticClass:"fr",attrs:{type:"primary"},on:{click:function(e){t.onClickOneKey("all")}}},[t._v("全部一键爬取")])],1)],1)],1),t._v(" "),i("Card",{attrs:{shadow:""}},[i("Table",{ref:"table",attrs:{border:"","highlight-row":"",loading:t.loading,columns:t.columns,data:t.list}})],1),t._v(" "),i("Card",{attrs:{shadow:""}},[i("Page",{attrs:{current:t.params.page,"page-size":t.params.limit,total:t.total,"show-total":"","show-elevator":""},on:{"on-change":t.onClickSearch}})],1)],1)},a=[];o._withStripped=!0;var n={render:o,staticRenderFns:a};e.default=n}});